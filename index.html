<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eternel Design Portal</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.447.0/dist/umd/lucide.min.js"></script>
    <script src="https://unpkg.com/lucide-react@0.447.0/dist/umd/lucide-react.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .font-serif { font-family: 'Playfair Display', serif; }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #fda4af; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #fb7185; }

        @keyframes bounce-subtle {
            0%, 100% { transform: translate(-50%, 0); }
            50% { transform: translate(-50%, -10px); }
        }
        .notification-float {
            animation: bounce-subtle 2s infinite ease-in-out;
            position: fixed;
            top: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
        }
    </style>
</head>
<body class="bg-[#fcfdfe]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Ensure Lucide icons are loaded safely
        const Lucide = window.LucideReact || window.lucideReact || {};
        const { 
            Heart, MapPin, Image: ImageIcon, CheckCircle, Download, 
            Send, PlusCircle, Clock, Trash2, Globe, HardDrive, 
            Images, Settings, X, Calendar, User, Link: LinkIcon,
            ChevronRight, Copy, Info
        } = Lucide;

        // --- Configuration ---
        // ⚠️ PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL BELOW ⚠️
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyBDTdfOeg1EMIXLLB-guBsp7Yedwn247e8PlLUJ3zMxbnauKpzYXvKIRNGErgtZRDzxg/exec';
        
        const AVAILABLE_LANGUAGES = ["English", "Arabic", "French", "Italian", "Spanish", "German", "Turkish"];
        const LOGO_URL = "https://lh3.googleusercontent.com/d/1A9ZVt5Fbh-r2aRnb79-x_6Fj10YVQ4O8";

        // --- Components ---
        const InputField = ({ label, icon: Icon, type = "text", value, onChange, placeholder, required = true }) => (
            <div className="flex flex-col gap-1.5">
                <label className="text-sm font-bold text-slate-600 flex items-center gap-2">
                    {Icon && <Icon size={14} className="text-rose-400" />}
                    {label}
                </label>
                <input
                    type={type}
                    className="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-rose-100 focus:border-rose-400 outline-none transition-all placeholder:text-slate-300 text-slate-700 font-medium"
                    value={value}
                    onChange={onChange}
                    placeholder={placeholder}
                    required={required}
                />
            </div>
        );

        const App = () => {
            const [loading, setLoading] = useState(false);
            const [submitted, setSubmitted] = useState(false);
            const [notification, setNotification] = useState(null);
            const [configError, setConfigError] = useState(false);

            const [formData, setFormData] = useState({
                brideName: '', 
                groomName: '', 
                weddingDate: '',
                languages: ["English", "Arabic"],
                // Complex fields
                events: [{ id: Date.now(), title: 'Wedding Ceremony', time: '', venue: '', address: '', maps: '' }],
                heroImageUrl: '', 
                galleryPhotos: ['', '', '', '', '', ''],
                driveLink: '', 
                rsvpDeadline: '', 
                hashtag: '', 
                specialNotes: ''
            });

            // Check if URL is configured
            useEffect(() => {
                if (!GOOGLE_SCRIPT_URL || GOOGLE_SCRIPT_URL.includes('YOUR_GOOGLE_APPS_SCRIPT')) {
                    setConfigError(true);
                }
            }, []);

            const notify = (message, type = 'success') => {
                setNotification({ message, type });
                setTimeout(() => setNotification(null), 4000);
            };

            // --- Form Handlers ---
            const handleLanguageToggle = (lang) => {
                setFormData(prev => ({
                    ...prev,
                    languages: prev.languages.includes(lang) 
                        ? prev.languages.filter(l => l !== lang) 
                        : [...prev.languages, lang]
                }));
            };

            const handleGalleryChange = (index, value) => {
                const newGallery = [...formData.galleryPhotos];
                newGallery[index] = value;
                setFormData({ ...formData, galleryPhotos: newGallery });
            };

            const handleEventChange = (index, field, value) => {
                const newEvents = [...formData.events];
                newEvents[index][field] = value;
                setFormData({ ...formData, events: newEvents });
            };

            const addEvent = () => {
                setFormData({
                    ...formData,
                    events: [...formData.events, { id: Date.now(), title: '', time: '', venue: '', address: '', maps: '' }]
                });
            };

            const removeEvent = (index) => {
                if (formData.events.length <= 1) return;
                setFormData({ ...formData, events: formData.events.filter((_, i) => i !== index) });
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                
                if (configError) {
                    return notify("Please configure the Google Script URL in the code.", "error");
                }
                
                setLoading(true);
                try {
                    // Format complex data into readable strings for Google Sheets
                    const formattedEvents = formData.events.map(e => 
                        `${e.title || 'Event'}: ${e.time || 'TBD'} @ ${e.venue || 'TBD'} (${e.maps || 'No Link'})`
                    ).join('\n---\n');

                    const formattedGallery = formData.galleryPhotos.filter(p => p).join('\n');

                    const data = {
                        ...formData,
                        languages: formData.languages.join(', '),
                        events: formattedEvents,
                        galleryPhotos: formattedGallery,
                        submittedAt: new Date().toLocaleString()
                    };

                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });

                    setSubmitted(true);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } catch (err) {
                    console.error("Submission error:", err);
                    notify("Network error connecting to Google Sheets.", "error");
                } finally {
                    setLoading(false);
                }
            };

            if (submitted) {
                return (
                    <div className="min-h-screen bg-[#fafbfc] flex items-center justify-center p-4">
                        <div className="bg-white p-12 rounded-[3rem] shadow-2xl max-w-lg w-full text-center border border-rose-50">
                            <div className="w-20 h-20 bg-rose-50 rounded-full flex items-center justify-center mx-auto mb-6">
                                {CheckCircle ? <CheckCircle className="text-rose-500" size={40} /> : <div className="text-rose-500 text-3xl">✓</div>}
                            </div>
                            <h2 className="text-4xl font-serif font-bold text-slate-900 mb-4">Success!</h2>
                            <p className="text-slate-500 mb-10 text-lg">Your design brief has been sent to the planning spreadsheet.</p>
                            <button onClick={() => setSubmitted(false)} className="w-full bg-slate-900 text-white py-4 rounded-2xl font-bold hover:bg-slate-800 transition-all shadow-lg active:scale-[0.98]">
                                Add New Client
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen text-slate-900 pb-20">
                    {configError && (
                        <div className="bg-amber-100 text-amber-900 px-4 py-3 text-center text-sm font-bold border-b border-amber-200">
                             ⚠️ Setup Required: Please open the code and replace 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL' with your actual deployment URL.
                        </div>
                    )}

                    {notification && (
                        <div className={`notification-float px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-3 ${notification.type === 'error' ? 'bg-red-500 text-white' : 'bg-slate-900 text-white'}`}>
                            {Info && <Info size={18} />}
                            <span className="font-semibold">{notification.message}</span>
                        </div>
                    )}

                    <nav className="sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100 px-6 py-3">
                        <div className="max-w-6xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-4">
                                <img src={LOGO_URL} alt="Logo" className="h-9 w-auto object-contain rounded-md" />
                                <div>
                                    <h1 className="font-serif text-2xl font-black text-slate-800 leading-none">ETERNEL<span className="text-rose-500">.EG</span></h1>
                                    <p className="text-[9px] uppercase tracking-widest font-black text-slate-400">Design Portal</p>
                                </div>
                            </div>
                        </div>
                    </nav>

                    <main className="max-w-4xl mx-auto px-6 py-12">
                        <header className="text-center mb-16 space-y-4">
                            <h2 className="text-5xl font-serif font-bold text-slate-900">Wedding Intake</h2>
                            <p className="text-slate-500 text-lg max-w-md mx-auto italic">Direct to Google Sheets Integration</p>
                        </header>

                        <form onSubmit={handleSubmit} className="space-y-8">
                            {/* Section 1: The Couple */}
                            <section className="bg-white rounded-[2.5rem] p-10 shadow-sm border border-slate-100">
                                <div className="flex items-center gap-4 mb-8">
                                    <div className="w-10 h-10 bg-rose-50 text-rose-500 rounded-xl flex items-center justify-center font-black">01</div>
                                    <h3 className="text-2xl font-serif font-bold text-slate-800">The Basics</h3>
                                </div>
                                <div className="grid md:grid-cols-2 gap-6 mb-8">
                                    <InputField label="Bride's Name" icon={User} value={formData.brideName} onChange={e => setFormData({...formData, brideName: e.target.value})} />
                                    <InputField label="Groom's Name" icon={User} value={formData.groomName} onChange={e => setFormData({...formData, groomName: e.target.value})} />
                                    <InputField label="Wedding Date" icon={Calendar} type="date" value={formData.weddingDate} onChange={e => setFormData({...formData, weddingDate: e.target.value})} />
                                    <InputField label="Hashtag" icon={ImageIcon} required={false} placeholder="#Couple2024" value={formData.hashtag} onChange={e => setFormData({...formData, hashtag: e.target.value})} />
                                </div>
                                <div className="space-y-4">
                                    <label className="text-sm font-bold text-slate-600 flex items-center gap-2">{Globe && <Globe size={14} className="text-rose-400" />} Languages</label>
                                    <div className="flex flex-wrap gap-2">
                                        {AVAILABLE_LANGUAGES.map(lang => (
                                            <button key={lang} type="button" onClick={() => handleLanguageToggle(lang)} className={`px-4 py-2 rounded-xl text-xs font-bold transition-all border-2 ${formData.languages.includes(lang) ? 'bg-rose-500 border-rose-500 text-white shadow-lg' : 'bg-white border-slate-100 text-slate-400 hover:border-rose-200'}`}>{lang}</button>
                                        ))}
                                    </div>
                                </div>
                            </section>

                            {/* Section 2: Itinerary (Restored) */}
                            <section className="bg-white rounded-[2.5rem] p-10 shadow-sm border border-slate-100">
                                <div className="flex items-center justify-between mb-8">
                                    <div className="flex items-center gap-4">
                                        <div className="w-10 h-10 bg-rose-50 text-rose-500 rounded-xl flex items-center justify-center font-black">02</div>
                                        <h3 className="text-2xl font-serif font-bold text-slate-800">Itinerary</h3>
                                    </div>
                                    <button type="button" onClick={addEvent} className="text-rose-500 font-bold hover:bg-rose-50 px-4 py-2 rounded-xl flex items-center gap-2 transition-colors">
                                        {PlusCircle && <PlusCircle size={18} />} Add Event
                                    </button>
                                </div>
                                <div className="space-y-8">
                                    {formData.events.map((event, idx) => (
                                        <div key={event.id} className="p-8 rounded-3xl bg-slate-50/50 border border-slate-100 relative group">
                                            <div className="flex justify-between items-center mb-6">
                                                <input 
                                                    value={event.title} 
                                                    onChange={e => handleEventChange(idx, 'title', e.target.value)} 
                                                    className="bg-transparent border-none p-0 font-bold text-slate-800 text-lg focus:ring-0 w-full"
                                                    placeholder="Event Name (e.g. Reception)"
                                                />
                                                {formData.events.length > 1 && (
                                                    <button type="button" onClick={() => removeEvent(idx)} className="text-slate-300 hover:text-rose-500 transition-colors">
                                                        {Trash2 && <Trash2 size={18} />}
                                                    </button>
                                                )}
                                            </div>
                                            <div className="grid md:grid-cols-2 gap-6">
                                                <InputField label="Time" icon={Clock} value={event.time} onChange={e => handleEventChange(idx, 'time', e.target.value)} placeholder="8:00 PM" />
                                                <InputField label="Venue" icon={MapPin} value={event.venue} onChange={e => handleEventChange(idx, 'venue', e.target.value)} placeholder="Grand Ballroom" />
                                                <InputField label="Maps Link" icon={LinkIcon} required={false} value={event.maps} onChange={e => handleEventChange(idx, 'maps', e.target.value)} placeholder="Google Maps URL" />
                                                <InputField label="Address" icon={MapPin} required={false} value={event.address} onChange={e => handleEventChange(idx, 'address', e.target.value)} placeholder="Street Name, City" />
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </section>

                            {/* Section 3: Media Assets (Restored) */}
                            <section className="bg-white rounded-[2.5rem] p-10 shadow-sm border border-slate-100">
                                <div className="flex items-center gap-4 mb-8">
                                    <div className="w-10 h-10 bg-slate-900 text-white rounded-xl flex items-center justify-center font-black">03</div>
                                    <h3 className="text-2xl font-serif font-bold text-slate-800">Media Assets</h3>
                                </div>
                                <div className="space-y-8">
                                    <InputField label="Hero Image URL (Main Cover)" icon={ImageIcon} value={formData.heroImageUrl} onChange={e => setFormData({...formData, heroImageUrl: e.target.value})} placeholder="https://example.com/photo.jpg" />
                                    
                                    <div className="space-y-4">
                                        <label className="text-sm font-bold text-slate-600 flex items-center gap-2">
                                            {Images && <Images size={14} className="text-rose-400" />} Gallery Photos (Direct URLs)
                                        </label>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            {formData.galleryPhotos.map((photo, idx) => (
                                                <input 
                                                    key={idx} 
                                                    type="text" 
                                                    className="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-xs placeholder:text-slate-300 focus:ring-2 focus:ring-rose-50 focus:border-rose-200 outline-none" 
                                                    placeholder={`Photo ${idx+1} URL`} 
                                                    value={photo} 
                                                    onChange={e => handleGalleryChange(idx, e.target.value)} 
                                                />
                                            ))}
                                        </div>
                                    </div>

                                    <div className="grid md:grid-cols-2 gap-8">
                                        <InputField label="Drive Link (Backup)" icon={HardDrive} required={false} value={formData.driveLink} onChange={e => setFormData({...formData, driveLink: e.target.value})} />
                                        <InputField label="RSVP Deadline" icon={Clock} type="date" value={formData.rsvpDeadline} onChange={e => setFormData({...formData, rsvpDeadline: e.target.value})} />
                                    </div>

                                    <div className="flex flex-col gap-1.5">
                                        <label className="text-sm font-bold text-slate-600 flex items-center gap-2">
                                            {PlusCircle && <PlusCircle size={14} className="text-rose-400" />} Special Notes
                                        </label>
                                        <textarea 
                                            className="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-rose-100 focus:border-rose-400 outline-none transition-all placeholder:text-slate-300 text-slate-700 font-medium h-28"
                                            placeholder="Themes, colors, or special requests..."
                                            value={formData.specialNotes}
                                            onChange={e => setFormData({...formData, specialNotes: e.target.value})}
                                        />
                                    </div>
                                </div>
                            </section>

                            <button type="submit" disabled={loading} className="w-full bg-slate-900 text-white py-6 rounded-[2rem] font-black text-xl hover:bg-slate-800 shadow-2xl transition-all active:scale-[0.98]">
                                {loading ? 'Sending to Sheet...' : 'Finalize & Submit'}
                            </button>
                        </form>
                    </main>
                    <footer className="mt-20 pt-12 text-center opacity-30 grayscale">
                        <img src={LOGO_URL} alt="Logo" className="h-6 mx-auto mb-4" />
                        <p className="text-[10px] font-black tracking-widest text-slate-400 uppercase">Eternel Design &copy; 2024</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
